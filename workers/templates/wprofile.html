{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Page</title>
    <link rel="stylesheet" href="{% static 'CSS/wprofile.css' %}?v=3.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"/>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h2 class="logo">Smart City<br>Portal</h2>
            
            <!-- Profile Picture Upload Form -->
            <form method="POST" enctype="multipart/form-data" class="profile-pic-form" action="{% url 'profile' %}">
                {% csrf_token %}
                <div class="image-p">
                    <label for="image-upload">
                        <img src="{% if user.image %}{{ user.image.url }}{% else %}{% static 'default.jpg' %}{% endif %}" alt="Profile Picture">
                    </label>
                </div>
                <input type="file" name="image" id="image-upload" onchange="this.form.submit()">
            </form>
            
            <!-- User Email -->
            <h2>{{ user.email }}</h2>
            
            <!-- Navigation Menu -->
            <nav class="menu">
                <a href="{% url 'wdashboard' %}"><i class="fa-solid fa-gauge"></i> Dashboard</a>
                <a href="{% url 'wprofile' %}" class="active"><i class="fa-solid fa-user"></i> Profile</a>
                <a href="{% url 'new_work' %}"><i class="fa-solid fa-briefcase"></i> New Work
                    {% if new_work_count > 0 %}
                    <span style="margin-left:8px; padding:2px 8px; border-radius:999px; background:#ef4444; color:#fff; font-size:12px; display:inline-block; vertical-align:middle;">+{{ new_work_count }}</span>
                    {% endif %}
                </a>
                <a href="{% url 'completed_complaints' %}"><i class="fa-solid fa-check"></i> Completed Complaints</a>
                <a href="{% url 'reset_password' user.id %}"><i class="fa-solid fa-key"></i> Reset Password</a>
                <a href="{% url 'wlogin' %}"><i class="fa-solid fa-right-from-bracket"></i> Logout</a>
            </nav>
        </aside>
    
        <!-- Content Area -->
        <div class="content">
            <div class="section">
                <h1>Welcome, {{ user.name }} </h1>
                <form method="POST">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" name="name" id="name" value="{{ user.name }}">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" name="email" id="email" value="{{ user.email }}" readonly>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="text" name="mobileno" id="mobileno" value="{{ user.mobileno }}">
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea name="address" id="address">{{ user.address }}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="department">Department</label>
                        <input type="text" name="department" id="department" value="{{user.department}}">
                    </div>
                    <div class="form-group">
                        <label for="availability">is_available</label>
                        <input type="text" name="avaialbility" id="avaialbility" value="{{ user.avaialbility}}">
                    </div>   
                    <div class="form-group">
                        <input type="submit" value="Save Changes">
                    </div>
                </form>
            </div>
        </div>
        </div>
        
    </div>
    {% if messages %}
        {% for message in messages %}
            <script>alert("{{ message }}");</script>
        {% endfor %}
    {% endif %}
    </body>
</html>    