{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Completed Complaints</title>
    <link rel="stylesheet" href="{% static 'CSS/wdashboard.css' %}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"/>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h2 class="logo">Smart City<br>Portal</h2>
            <nav class="menu">
                <a href="{% url 'wdashboard' %}"><i class="fa-solid fa-gauge"></i> Dashboard</a>
                <a href="{% url 'wprofile' %}"><i class="fa-solid fa-user"></i> Profile</a>
                <a href="{% url 'new_work' %}"><i class="fa-solid fa-briefcase"></i> New Work
                    {% if new_work_count > 0 %}
                    <span style="margin-left:8px; padding:2px 8px; border-radius:999px; background:#ef4444; color:#fff; font-size:12px; display:inline-block; vertical-align:middle;">+{{ new_work_count }}</span>
                    {% endif %}
                </a>
                <a href="{% url 'completed_complaints' %}" class="active"><i class="fa-solid fa-check"></i> Completed Complaints</a>
                <a href="{% url 'reset_password' user.id %}"><i class="fa-solid fa-key"></i> Reset Password</a>
                <a href="{% url 'wlogin' %}"><i class="fa-solid fa-right-from-bracket"></i> Logout</a>
            </nav>
        </aside>

        <main class="main-content">
            <h1>Completed Complaints</h1>
            <p>Complaints you completed after assignment.</p>

            {% if assignments %}
            <table style="width:100%; border-collapse:collapse; margin-top:10px;">
                <thead>
                    <tr>
                        <th style="text-align:left; padding:8px;">Complaint</th>
                        <th style="text-align:left; padding:8px;">Type</th>
                        <th style="text-align:left; padding:8px;">Location</th>
                        <th style="text-align:left; padding:8px;">Priority</th>
                        <th style="text-align:left; padding:8px;">Assigned At</th>
                        <th style="text-align:left; padding:8px;">Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for a in assignments %}
                    <tr>
                        <td style="padding:8px;">#{{ a.complaint.id }}</td>
                        <td style="padding:8px;">{{ a.complaint.comType }}</td>
                        <td style="padding:8px;">{{ a.complaint.location }}</td>
                        <td style="padding:8px;">{{ a.complaint.priority }}</td>
                        <td style="padding:8px;">{{ a.assigned_at|date:"M d, Y H:i" }}</td>
                        <td style="padding:8px; font-weight:600; color:#059669;">{{ a.complaint.status }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p>No completed complaints yet.</p>
            {% endif %}
        </main>
    </div>
</body>
</html>


